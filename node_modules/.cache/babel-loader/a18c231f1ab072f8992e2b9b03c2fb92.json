{"ast":null,"code":"import _toConsumableArray from\"/Users/chi-shanyu/Desktop/36-PWAShoppingCart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{Modal,Button,Select}from\"antd\";import{useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{Link,useHistory}from\"react-router-dom\";import{CartIcon}from\"./Icons\";import{addCartItem,removeCartItem}from\"../actions/cartActions\";import{setProductDetail}from\"../actions/productActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Option=Select.Option;export default function CartModal(_ref){var isModalVisible=_ref.isModalVisible,toggleModal=_ref.toggleModal;var _useSelector=useSelector(function(state){return state.cart;}),cartItems=_useSelector.cartItems;var dispatch=useDispatch();var history=useHistory();var handleCancel=function handleCancel(){return toggleModal(!isModalVisible);};var getTotalPrice=function getTotalPrice(){return cartItems.length>0?cartItems.reduce(function(sum,item){return sum+item.price*item.qty;},0):0;};var checkoutHandler=function checkoutHandler(){handleCancel();history.push(\"/login?redirect=shipping\");};useEffect(function(){localStorage.setItem(\"cartItems\",JSON.stringify(cartItems));},[cartItems]);return/*#__PURE__*/_jsxs(Modal,{title:\"Shopping Bag\",visible:isModalVisible,onCancel:handleCancel,footer:null,children:[cartItems.length===0?/*#__PURE__*/_jsx(\"div\",{children:\"Cart is empty\"}):cartItems.map(function(item){return/*#__PURE__*/_jsxs(\"li\",{className:\"cart-item\",children:[/*#__PURE__*/_jsx(Link,{to:\"/products/\".concat(item.category,\"/\").concat(item.id),children:/*#__PURE__*/_jsx(\"div\",{className:\"cart-image\",onClick:function onClick(){dispatch(setProductDetail(item.id,item.qty));handleCancel();},children:/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cart-name\",children:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-qty\",children:[\"Qty: \",\"   \",/*#__PURE__*/_jsx(Select,{defaultValue:item.qty,value:item.qty,className:\"select-style\",onChange:function onChange(qty){return dispatch(addCartItem(item,qty));},children:_toConsumableArray(Array(item.countInStock).keys()).map(function(x){return/*#__PURE__*/_jsx(Option,{value:x+1,children:x+1},x+1);})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item-end\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"cart-price\",children:[\"$\",item.price*item.qty]}),/*#__PURE__*/_jsx(\"div\",{className:\"cart-item-delete\",onClick:function onClick(){return dispatch(removeCartItem(item.id));},children:\"x\"})]})]},item.id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total-price-wrap\",children:[\"Total\",/*#__PURE__*/_jsxs(\"div\",{className:\"cart-total-price\",children:[\"$\",getTotalPrice()]})]}),/*#__PURE__*/_jsxs(Button,{className:\"cart-modal-btn\",type:\"primary\",onClick:checkoutHandler,children:[/*#__PURE__*/_jsx(CartIcon,{size:20}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:12},children:\"Start Checkout\"})]})]});}","map":{"version":3,"sources":["/Users/chi-shanyu/Desktop/36-PWAShoppingCart/src/components/CartModal.js"],"names":["Modal","Button","Select","useEffect","useDispatch","useSelector","Link","useHistory","CartIcon","addCartItem","removeCartItem","setProductDetail","Option","CartModal","isModalVisible","toggleModal","state","cart","cartItems","dispatch","history","handleCancel","getTotalPrice","length","reduce","sum","item","price","qty","checkoutHandler","push","localStorage","setItem","JSON","stringify","map","category","id","image","name","Array","countInStock","keys","x","marginLeft"],"mappings":"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","sourcesContent":["import { Modal, Button, Select } from \"antd\";\nimport { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport { CartIcon } from \"./Icons\";\nimport { addCartItem, removeCartItem } from \"../actions/cartActions\";\nimport {setProductDetail} from \"../actions/productActions\";\n\nconst { Option } = Select;\n\nexport default function CartModal({ isModalVisible, toggleModal }) {\n  const { cartItems } = useSelector((state) => state.cart);\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const handleCancel = () => toggleModal(!isModalVisible);\n  const getTotalPrice = () => {\n    return cartItems.length > 0\n      ? cartItems.reduce((sum, item) => sum + item.price * item.qty, 0)\n      : 0;\n  };\n\n  const checkoutHandler = () => {\n    handleCancel();\n    history.push(\"/login?redirect=shipping\");\n  };\n\n  useEffect(() => {\n    localStorage.setItem(\"cartItems\", JSON.stringify(cartItems));\n  }, [cartItems]);\n\n  return (\n    <Modal\n      title=\"Shopping Bag\"\n      visible={isModalVisible}\n      onCancel={handleCancel}\n      footer={null}\n    >\n      {cartItems.length === 0 ? (\n        <div>Cart is empty</div>\n      ) : (\n        cartItems.map((item) => (\n          <li key={item.id} className=\"cart-item\">\n            <Link to={`/products/${item.category}/${item.id}`}>\n              <div\n                className=\"cart-image\"\n                onClick={() => {\n                  dispatch(setProductDetail(item.id, item.qty));\n                  handleCancel();\n                }}\n              >\n                <img src={item.image} alt={item.name} />\n              </div>\n            </Link>\n            <div className=\"cart-item-content\">\n              <div className=\"cart-name\">{item.name}</div>\n              <div className=\"product-qty\">\n                Qty: {\"   \"}\n                <Select\n                  defaultValue={item.qty}\n                  value={item.qty}\n                  className=\"select-style\"\n                  onChange={(qty) => dispatch(addCartItem(item, qty))}\n                >\n                  {[...Array(item.countInStock).keys()].map((x) => (\n                    <Option key={x + 1} value={x + 1}>\n                      {x + 1}\n                    </Option>\n                  ))}\n                </Select>\n              </div>\n            </div>\n            <div className=\"cart-item-end\">\n              <div className=\"cart-price\">${item.price * item.qty}</div>\n              <div\n                className=\"cart-item-delete\"\n                onClick={() => dispatch(removeCartItem(item.id))}\n              >\n                x\n              </div>\n            </div>\n          </li>\n        ))\n      )}\n      <div className=\"cart-total-price-wrap\">\n        Total\n        <div className=\"cart-total-price\">${getTotalPrice()}</div>\n      </div>\n      <Button\n        className=\"cart-modal-btn\"\n        type=\"primary\"\n        onClick={checkoutHandler}\n      >\n        <CartIcon size={20} />\n        <span style={{ marginLeft: 12 }}>Start Checkout</span>\n      </Button>\n    </Modal>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}