{"ast":null,"code":"import _regeneratorRuntime from\"/Users/chi-shanyu/Desktop/36-PWAShoppingCart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/chi-shanyu/Desktop/36-PWAShoppingCart/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{BEGIN_LOGIN_REQUEST,SUCCESS_LOGIN_REQUEST,FAIL_LOGIN_REQUEST,BEGIN_REGISTER_REQUEST,SUCCESS_REGISTER_REQUEST,FAIL_REGISTER_REQUEST,BEGIN_UPDATE_USERINFO,SUCCESS_UPDATE_USERINFO,FAIL_UPDATE_USERINFO,LOGOUT_REQUEST,REMEMBER_LOGIN}from\"../utils/constants\";import{signInWithEmailPassword,registerWithEmailPassword,updateProfile}from\"../api\";export var login=function login(userInfo){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:BEGIN_LOGIN_REQUEST});_context.prev=1;_context.next=4;return signInWithEmailPassword(userInfo.email,userInfo.password);case 4:res=_context.sent;console.log(\"after login ...\");console.log(res);if(!(res.status===200)){_context.next=13;break;}dispatch({type:SUCCESS_LOGIN_REQUEST,payload:res.user});localStorage.setItem(\"userInfo\",JSON.stringify(res.user));return _context.abrupt(\"return\",res.user);case 13:dispatch({type:FAIL_LOGIN_REQUEST,payload:\"\".concat(res.status,\" error!\\n        \").concat(res.detail)});return _context.abrupt(\"return\",null);case 15:_context.next=23;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](1);console.log(_context.t0);dispatch({type:FAIL_LOGIN_REQUEST,payload:_context.t0});console.log(_context.t0);return _context.abrupt(\"return\",null);case 23:case\"end\":return _context.stop();}}},_callee,null,[[1,17]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var register=function register(userInfo){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch({type:BEGIN_REGISTER_REQUEST});_context2.prev=1;_context2.next=4;return registerWithEmailPassword(userInfo.email,userInfo.password,userInfo.username);case 4:res=_context2.sent;if(!(res.status===200)){_context2.next=11;break;}dispatch({type:SUCCESS_REGISTER_REQUEST,payload:res.user});localStorage.setItem(\"userInfo\",JSON.stringify(res.user));return _context2.abrupt(\"return\",res.user);case 11:dispatch({type:FAIL_REGISTER_REQUEST,payload:\"\".concat(res.status,\" error!\\n        \").concat(res.detail)});return _context2.abrupt(\"return\",null);case 13:_context2.next=20;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](1);dispatch({type:FAIL_REGISTER_REQUEST,payload:_context2.t0});console.log(_context2.t0);return _context2.abrupt(\"return\",null);case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[1,15]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var rememberLoginUser=function rememberLoginUser(remember){return function(dispatch){dispatch({type:REMEMBER_LOGIN,payload:remember});};};export var updateUserInfo=function updateUserInfo(userInfo){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch({type:BEGIN_UPDATE_USERINFO});_context3.prev=1;_context3.next=4;return updateProfile(userInfo.username,userInfo.password,userInfo.address||\"\",userInfo.tel||\"\",userInfo.access_token,userInfo.user_id);case 4:res=_context3.sent;if(!(res.status===200)){_context3.next=11;break;}dispatch({type:SUCCESS_UPDATE_USERINFO,payload:res.user});localStorage.setItem(\"userInfo\",JSON.stringify(res.user));return _context3.abrupt(\"return\",res.user);case 11:dispatch({type:FAIL_UPDATE_USERINFO,payload:\"\".concat(res.status,\" error!\\n        \").concat(res.detail)});return _context3.abrupt(\"return\",null);case 13:_context3.next=20;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](1);dispatch({type:FAIL_UPDATE_USERINFO,payload:_context3.t0});console.log(_context3.t0);return _context3.abrupt(\"return\",null);case 20:case\"end\":return _context3.stop();}}},_callee3,null,[[1,15]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch({type:LOGOUT_REQUEST});localStorage.removeItem(\"userInfo\");case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};","map":{"version":3,"sources":["/Users/chi-shanyu/Desktop/36-PWAShoppingCart/src/actions/userActions.js"],"names":["BEGIN_LOGIN_REQUEST","SUCCESS_LOGIN_REQUEST","FAIL_LOGIN_REQUEST","BEGIN_REGISTER_REQUEST","SUCCESS_REGISTER_REQUEST","FAIL_REGISTER_REQUEST","BEGIN_UPDATE_USERINFO","SUCCESS_UPDATE_USERINFO","FAIL_UPDATE_USERINFO","LOGOUT_REQUEST","REMEMBER_LOGIN","signInWithEmailPassword","registerWithEmailPassword","updateProfile","login","userInfo","dispatch","type","email","password","res","console","log","status","payload","user","localStorage","setItem","JSON","stringify","detail","register","username","rememberLoginUser","remember","updateUserInfo","address","tel","access_token","user_id","logout","removeItem"],"mappings":"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","sourcesContent":["import {\n  BEGIN_LOGIN_REQUEST,\n  SUCCESS_LOGIN_REQUEST,\n  FAIL_LOGIN_REQUEST,\n  BEGIN_REGISTER_REQUEST,\n  SUCCESS_REGISTER_REQUEST,\n  FAIL_REGISTER_REQUEST,\n  BEGIN_UPDATE_USERINFO,\n  SUCCESS_UPDATE_USERINFO,\n  FAIL_UPDATE_USERINFO,\n  LOGOUT_REQUEST,\n  REMEMBER_LOGIN,\n} from \"../utils/constants\";\nimport {\n  signInWithEmailPassword,\n  registerWithEmailPassword,\n  updateProfile,\n} from \"../api\";\n\nexport const login = (userInfo) => async (dispatch) => {\n  dispatch({ type: BEGIN_LOGIN_REQUEST });\n  try {\n    const res = await signInWithEmailPassword(\n      userInfo.email,\n      userInfo.password\n    );\n    console.log(\"after login ...\");\n    console.log(res);\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_LOGIN_REQUEST,\n        payload: res.user,\n      });\n      localStorage.setItem(\"userInfo\", JSON.stringify(res.user));\n      return res.user;\n    } else {\n      dispatch({\n        type: FAIL_LOGIN_REQUEST,\n        payload: `${res.status} error!\n        ${res.detail}`,\n      });\n      return null;\n    }\n  } catch (e) {\n    console.log(e);\n    dispatch({\n      type: FAIL_LOGIN_REQUEST,\n      payload: e,\n    });\n    console.log(e);\n    return null;\n  }\n};\n\nexport const register = (userInfo) => async (dispatch) => {\n  dispatch({ type: BEGIN_REGISTER_REQUEST });\n  try {\n    const res = await registerWithEmailPassword(\n      userInfo.email,\n      userInfo.password,\n      userInfo.username\n    );\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_REGISTER_REQUEST,\n        payload: res.user,\n      });\n      localStorage.setItem(\"userInfo\", JSON.stringify(res.user));\n      return res.user;\n    } else {\n      dispatch({\n        type: FAIL_REGISTER_REQUEST,\n        payload: `${res.status} error!\n        ${res.detail}`,\n      });\n      return null;\n    }\n  } catch (e) {\n    dispatch({\n      type: FAIL_REGISTER_REQUEST,\n      payload: e,\n    });\n    console.log(e);\n    return null;\n  }\n};\n\nexport const rememberLoginUser = (remember) => (dispatch) => {\n  dispatch({\n    type: REMEMBER_LOGIN,\n    payload: remember,\n  });\n};\n\nexport const updateUserInfo = (userInfo) => async (dispatch) => {\n  dispatch({ type: BEGIN_UPDATE_USERINFO });\n  try {\n    const res = await updateProfile(\n      userInfo.username,\n      userInfo.password,\n      userInfo.address || \"\",\n      userInfo.tel || \"\",\n      userInfo.access_token,\n      userInfo.user_id\n    );\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_UPDATE_USERINFO,\n        payload: res.user,\n      });\n      localStorage.setItem(\"userInfo\", JSON.stringify(res.user));\n      return res.user;\n    } else {\n      dispatch({\n        type: FAIL_UPDATE_USERINFO,\n        payload: `${res.status} error!\n        ${res.detail}`,\n      });\n      return null;\n    }\n  } catch (e) {\n    dispatch({\n      type: FAIL_UPDATE_USERINFO,\n      payload: e,\n    });\n    console.log(e);\n    return null;\n  }\n};\n\nexport const logout = () => async (dispatch) => {\n  dispatch({ type: LOGOUT_REQUEST });\n  localStorage.removeItem(\"userInfo\");\n};\n\n\n"]},"metadata":{},"sourceType":"module"}